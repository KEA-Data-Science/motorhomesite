<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>New Reservation</title>
</head>
<body>

<!--    styling fragment -->
<div th:replace="fragments/styling.html :: styling"></div>

<!-- navbar fragment -->
<div th:replace="fragments/navbar.html :: navigation"></div>

<!-- Reservation(s) displayed -->
<div class="container content-auto-margins">
    <h1 id="headline" class="content-auto-margins">New Reservation</h1>
    <div class="container95 content-auto-margins">
        <div th:each="reservation : ${reservations}">
            <div class="fuel-type" th:text="${'Reservation ID: '+ reservation.getReservationID()}"></div>
            <p></p>
            <!--            Motorhome overview, collapsible -->
            <button class="collapsible">
                <span>Motorhome details.</span>
                <img src="/img/transparent-100-10.png" style="display: inline-block">
                <span th:text="${'Licence plate: ['+reservation.getMotorhome().getLicensePlate()+ ']'}"></span>
                <img src="/img/transparent-100-10.png" style="display: inline-block">

                <span th:text="${'Model: '+reservation.getMotorhome().getModel().getModelName()}"></span>
            </button>
            <div class="collapsible-content">
                <img class="thumbnail" th:src="@{${reservation.getMotorhome().imageURL}}" alt="Image Coming Up!"/>
                <table>
                    <tr>
                        <td class="item-description">
                            <div class="model-name" th:text="${reservation.getMotorhome().getModel()}"></div>
                            <div class=""
                                 th:text="'Winter daily charge:'+${reservation.getMotorhome().getSeasonalDailyCharge()[0]}"></div>
                            <div class=""
                                 th:text="'Spring daily charge: '+${reservation.getMotorhome().getSeasonalDailyCharge()[1]}"></div>
                            <div class=""
                                 th:text="'Summber daily charge: '+${reservation.getMotorhome().getSeasonalDailyCharge()[2]}"></div>
                        </td>
                        <td>
                            <div>
                                <!--                                Details link should open details page in a separate window -->
                                <button class="button animate border-8px"><span>Details </span></button>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>

            <!--            Period of reservation -->
            <div class="hl"><h3>Period</h3></div>
            <span class="fuel-type">Duration of reservation:
                <!--                    måned og år bliver kun vist hvis de er relevante -->
                <span th:text="${reservation.getPeriod().duration()[0] +' days ' +
                    (reservation.getPeriod().duration()[1]==0? '': reservation.getPeriod().duration()[1] +' months ')+
                    (reservation.getPeriod().duration()[2]==0? '': reservation.getPeriod().duration()[2] +' year')}">
                </span>
            </span>
            <div>
                <table class="content-auto-margins">
                    <tr>
                        <td class="center-text">Start Date</td>
                        <td><img src="/img/transparent-100-10.png"/></td>
                        <td class="center-text">End Date</td>
                    </tr>
                    <tr>
                        <td class="center-text fuel-type" th:text="${reservation.getPeriod().getStartAsDate()}"></td>
                        <td><img src="/img/transparent-100-10.png"/></td>
                        <td class="center-text fuel-type" th:text="${reservation.getPeriod().getEndAsDate()}"></td>
                    </tr>
                    <tr>
                        <td class="center-text"
                            th:text="${priceCalculator.getDateUtil().determineSeasonOfDate(reservation.getPeriod().getStart())+' Season'}"></td>
                        <td><img src="/img/transparent-100-10.png"/></td>
                        <td class="center-text"
                            th:text="${priceCalculator.getDateUtil().determineSeasonOfDate(reservation.getPeriod().getEnd())+' Season'}"></td>
                    </tr>
                </table>
                <!-- Base price -->
                <div class="hl"><h3>Base price</h3></div>
                <table>
                    <tr>
                        <td>Low Season Daily Price:</td>
                        <td>
                            <div th:text="'' + ${reservation.getMotorhome().getSeasonalDailyCharge()[0]}"></div>
                        </td>
                    </tr>
                    <tr>
                        <td>Medium Season Daily Price:</td>
                        <td>
                            <div th:text="'' + ${reservation.getMotorhome().getSeasonalDailyCharge()[1]}"></div>
                        </td>
                    </tr>
                    <tr>
                        <td>High Season Daily Price:</td>
                        <td>
                            <div th:text="'' + ${reservation.getMotorhome().getSeasonalDailyCharge()[2]}"></div>
                        </td>
                    </tr>
                </table>
                <div>
                    <div class="fuel-type">
                        <span> Base price for rental of vehicle in period: </span>
                        <span th:text="${priceCalculator.calculatePriceOfPeriod(reservation.getMotorhome(),reservation.getPeriod())}"></span>
                    </div>
                </div>

                <!--                available services -->
                <div class="wrapper" id="servicesavailable">

                    <div th:each="service:${reservation.getMotorhome().getServicesAvailable()}">

                            <div class="box">
                                <table>
                                    <tr>
                                        <td class="item-description">
                                            <div th:text="${'Service ID: '+service.getServiceID()}"></div>
                                            <div th:text="${'Name: '+service.getName()}"></div>
                                            <div th:text="${'Unit price: '+service.unitPrice}"></div>

                                            <button class="collapsible">Description: ...</button>
                                            <div class="collapsible-content" th:text="${service.getDescription()}"></div>
                                        </td>
                                        <td>
                                            <form action="/reservation/addservice#servicesavailable" method="post" th:id="${'availableS'+service.getServiceID()}">
                                                <input type="hidden"  name="serviceID" th:value="${service.getServiceID()}">
                                                <input type="hidden" name="reservationID" th:value="${reservation.getReservationID()}">
                                            <div>
                                                <button class="animate border-8px" th:form="${'availableS'+service.getServiceID()}">Add Service</button>
                                            </div>
                                            </form>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                    </div>
                </div>
                <!--                Services offered for vehicle -->
                <div class="hl" id="serviceschosen">Services Chosen</div>
                <div class="wrapper">

                    <div th:each="service:${reservation.getServices()}">

                            <div class="box">
                                <table>
                                    <tr>
                                        <td class="item-description">
                                            <div th:text="${'Service ID: '+service.getServiceID()}"></div>
                                            <div th:text="${'Name: '+service.getName()}"></div>
                                            <div th:text="${'Unit price: '+service.unitPrice}"></div>
                                            <button class="collapsible">Description: ...</button>
                                            <div class="collapsible-content" th:text="${service.getDescription()}"></div>
                                        </td>
                                        <td>
                                            <form action="/reservation/removeservice#serviceschosen" method="post" th:id="${'chosenS'+service.getServiceID()}">
                                                <input type="hidden" name="serviceID" th:value="${service.getServiceID()}">
                                                <input type="hidden" name="reservationID" th:value="${reservation.getReservationID()}">
                                                <div>
                                                    <button class="animate border-8px" th:form="${'chosenS'+service.getServiceID()}">Remove Service</button>
                                                </div>
                                            </form>
                                        </td>
                                    </tr>
                                </table>
                            </div>

                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

<!-- javascript -->
<script>
    <!--    script adds an event listener to all elements with class name collapsible -->
    var coll = document.getElementsByClassName("collapsible");
    var i;

    for (i = 0; i < coll.length; i++) {
        coll[i].addEventListener("click", function () {
            this.classList.toggle("active"); // defaults to false
            var content = this.nextElementSibling;
            if (content.style.maxHeight) {
                content.style.maxHeight = null;
            } else {
                content.style.maxHeight = content.scrollHeight + "px";
            }
        });
    }
</script>

</body>
</html>